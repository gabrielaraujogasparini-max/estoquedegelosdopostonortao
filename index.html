<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Estoque de Gelos - Posto Nortão</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="icon" href="https://i.ibb.co/xSk1rq8m/Chat-GPT-Image-30-de-jan-de-2026-00-33-21.png">

<style>
body { font-family: Arial; background:#f1f4f9; margin:0; }
.container { max-width:420px; margin:auto; background:#fff; min-height:100vh; }
.topo-img { width:100%; display:block; }

.header { background:#0057b7; color:#fff; text-align:center; padding:12px; font-weight:bold; }
.header-red { background:#c40000; color:#fff; text-align:center; padding:6px; }

.content { padding:15px; }

button {
    width:100%; padding:12px; margin-top:12px;
    border:none; border-radius:6px; color:#fff;
    font-size:15px; cursor:pointer;
}
.blue { background:#0057b7; }
.red { background:#c40000; }
.gray { background:#555; }

label { font-weight:bold; display:block; margin-top:10px; }
select, input { width:100%; padding:8px; margin-top:5px; }

.estoque { text-align:center; font-size:18px; font-weight:bold; margin:10px 0; }

.hidden { display:none; }
.footer { text-align:center; font-size:12px; color:#666; padding:10px; }
</style>
</head>

<body>
<div class="container">

<img class="topo-img" src="https://i.ibb.co/xSk1rq8m/Chat-GPT-Image-30-de-jan-de-2026-00-33-21.png">

<div class="header">ESTOQUE DE GELOS</div>
<div class="header-red">Posto Nortão</div>

<div class="content" id="principal">

<button class="red" onclick="fecharTurno()">FECHAR TURNO</button>

<div class="estoque">
Estoque Atual: <span id="estoque">0</span> gelos
</div>

<label>Frentista</label>
<select id="frentista">
<option value="">Selecione</option>
<option>Gabriel</option><option>Robson</option><option>Vinícius</option>
<option>Vitor</option><option>Alexsandro</option><option>Tainara</option>
<option>Dinho</option><option>Ana Paula</option><option>Genival</option>
<option>Hakson</option><option>Eduardo</option>
</select>

<label>Quantidade vendida</label>
<input type="number" id="qtd" min="1">

<button class="blue" onclick="darBaixa()">Dar baixa e enviar WhatsApp</button>
<button class="gray" onclick="abrirSenha()">Atualizar estoque (restrito)</button>

</div>

<div class="content hidden" id="senhaPage">
<label>Senha</label>
<input type="password" id="senha">
<button class="blue" onclick="validarSenha()">Entrar</button>
<button class="gray" onclick="voltar()">Voltar</button>
</div>

<div class="content hidden" id="estoquePage">
<label>Novo estoque total</label>
<input type="number" id="novoEstoque">
<button class="red" onclick="atualizarEstoque()">Atualizar</button>
<button class="gray" onclick="voltar()">Voltar</button>
</div>

<div class="footer">Sistema interno • Posto Nortão</div>

</div>

<script>
let estoque = Number(localStorage.getItem("estoque")) || 0;
let vendas = JSON.parse(localStorage.getItem("vendas")) || [];
let turnoAtual = Number(localStorage.getItem("turno")) || 1;

document.getElementById("estoque").innerText = estoque;

function salvar() {
    localStorage.setItem("estoque", estoque);
    localStorage.setItem("vendas", JSON.stringify(vendas));
    localStorage.setItem("turno", turnoAtual);
    document.getElementById("estoque").innerText = estoque;
}

function darBaixa() {
    const f = frentista.value;
    const q = Number(qtd.value);
    if(!f || !q || q > estoque) return alert("Dados inválidos");

    estoque -= q;

    const agora = new Date();
    vendas.push({
        frentista:f,
        qtd:q,
        hora:agora.toLocaleTimeString("pt-BR"),
        data:agora.toLocaleDateString("pt-BR"),
        turno:turnoAtual
    });

    salvar();

    const msg =
`*BAIXA DE GELO*
*Frentista:* ${f}
*Quantidade:* ${q}
*Estoque atual:* ${estoque}
*Turno:* ${turnoAtual === 1 ? "Primeiro" : "Segundo"}

${agora.toLocaleDateString("pt-BR")} ${agora.toLocaleTimeString("pt-BR")}`;

    window.open("https://wa.me/?text="+encodeURIComponent(msg));
    qtd.value="";
}

function fecharTurno() {
    const vendasTurno = vendas.filter(v => v.turno === turnoAtual);
    if(vendasTurno.length === 0) return alert("Nenhuma venda no turno");

    let total = 0;
    let texto = `*FECHAMENTO ${turnoAtual === 1 ? "PRIMEIRO" : "SEGUNDO"} TURNO*\n\n`;

    vendasTurno.forEach(v=>{
        total += v.qtd;
        texto += `${v.frentista} - ${v.qtd} gelo(s) - ${v.hora}\n`;
    });

    texto += `\n*Total vendido:* ${total}
*Estoque final:* ${estoque}`;

    window.open("https://wa.me/?text="+encodeURIComponent(texto));

    vendas = vendas.filter(v => v.turno !== turnoAtual);
    turnoAtual = turnoAtual === 1 ? 2 : 1;
    if(turnoAtual === 1) vendas = [];

    salvar();
}

function abrirSenha(){
principal.classList.add("hidden");
senhaPage.classList.remove("hidden");
}

function validarSenha(){
if(senha.value==="Nortao2025"){
senhaPage.classList.add("hidden");
estoquePage.classList.remove("hidden");
}else alert("Senha incorreta");
}

function atualizarEstoque(){
estoque = Number(novoEstoque.value);
salvar(); voltar();
}

function voltar(){
senhaPage.classList.add("hidden");
estoquePage.classList.add("hidden");
principal.classList.remove("hidden");
}
</script>

</body>
</html>
